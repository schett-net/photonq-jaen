"use strict";(self.webpackChunkmy_gatsby_site=self.webpackChunkmy_gatsby_site||[]).push([[7701],{27701:function(e,r,t){t.r(r),t.d(r,{generateInternalToken:function(){return p},getAuthentication:function(){return b},setAuthentication:function(){return a},setAuthenticationCookies:function(){return f}});var n=t(99823),o=t(7966);function c(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function s(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){c(e,r,t[r])}))}return e}function i(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}var u={res1:["read","write"],res2:["read","write"]};function a(e,r){var t=(0,o.newAccessToken)({subject:e,payload:{scope:u}}),n=(0,o.newRefreshToken)({accessToken:t.token,payload:{scope:u}});return f(r,t.token,n.token),{accessToken:t.token,refreshToken:n.token}}function f(e,r,t){e.cookie(n.wr,r,i(s({},n.F6),{maxAge:1e3*n.v8})),e.cookie(n.b7,t,i(s({},n.F6),{maxAge:1e3*n.Vs}))}function b(e){var r=e.cookies[n.wr],t=e.cookies[n.b7],c=(0,o.verify)(r).sub;if(!c)throw new Error("No subject found in access token");return{userId:c,accessToken:r,refreshToken:t}}function p(e){var r,t=e.ressourceId,n=e.accessToken,c=(0,o.verify)(n);r=Array.isArray(c.scope)?c.scope:c.scope[t];var s=(0,o.newAccessToken)({subject:c.sub,payload:{scope:r}}).token;return"Bearer ".concat(s)}}}]);
//# sourceMappingURL=7701-292d9439eca4312875dd.js.map