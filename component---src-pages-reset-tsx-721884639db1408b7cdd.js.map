{"version":3,"file":"component---src-pages-reset-tsx-721884639db1408b7cdd.js","mappings":"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","sources":["webpack://my-gatsby-site/./src/components/Authentification/PasswordResetForm.tsx","webpack://my-gatsby-site/./src/pages/reset.tsx"],"sourcesContent":["import {Field} from '@jaenjs/jaen'\nimport {Alert, Snackbar, TextField} from '@mui/material'\nimport {red} from '@mui/material/colors'\nimport {Link} from 'gatsby'\nimport React, {useState} from 'react'\nimport {useTranslation} from 'react-i18next'\n\nimport {resetPassword} from '@snek-functions/origin'\n\nimport {Path} from '../../model/model.routes'\nimport LoadingButton from '../LoadingButton'\nimport AuthFormContainer from './AuthFormContainer'\nimport PasswordField from './PasswordField'\n\ninterface PasswordResetValues {\n  password: string\n  passwordConfirmation: string\n}\n\ninterface PasswordResetRequestValues {\n  email: string\n}\n\nconst getResetTokenFromWindowLocation = (): string | null => {\n  if (typeof window === 'undefined') {\n    return null\n  }\n\n  // get the token from the window location query string\n  const searchParams = new URLSearchParams(window.location.search)\n  const token = searchParams.get('token')\n\n  return token\n}\n\nexport default function PasswordResetForm() {\n  const {t} = useTranslation()\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState('')\n  const [resetRequested, setResetRequested] = React.useState(false)\n  const [passwordResetValues, setPasswordResetValues] =\n    useState<PasswordResetValues>({\n      password: '',\n      passwordConfirmation: ''\n    })\n\n  const [passwordResetRequestValues, setPasswordResetRequestValues] =\n    useState<PasswordResetRequestValues>({\n      email: ''\n    })\n\n  // If the token is present in the window location, we are in the reset step.\n  // Otherwise, we are in the request step.\n  const [resetToken, setResetToken] = useState(\n    getResetTokenFromWindowLocation()\n  )\n\n  React.useEffect(() => {\n    setResetToken(getResetTokenFromWindowLocation())\n  }, [window.location])\n\n  const handleResetOnChange = (\n    e: React.ChangeEvent<HTMLTextAreaElement | HTMLInputElement>,\n    key: keyof PasswordResetValues\n  ) => {\n    setPasswordResetValues(prev => ({...prev, [key]: e.target.value}))\n  }\n\n  const handleResetRequestOnChange = (\n    e: React.ChangeEvent<HTMLTextAreaElement | HTMLInputElement>,\n    key: keyof PasswordResetRequestValues\n  ) => {\n    setPasswordResetRequestValues(prev => ({...prev, [key]: e.target.value}))\n  }\n\n  const reset = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault()\n    setIsLoading(true)\n    try {\n      setError('')\n\n      if (resetToken === null) {\n        await resetPassword({\n          email: passwordResetRequestValues.email\n        })\n        setResetRequested(true)\n      } else {\n        if (\n          passwordResetValues.password ===\n          passwordResetValues.passwordConfirmation\n        ) {\n          const res = await fetch(\n            `https://photonq.at/submit?token=${resetToken}`,\n            {\n              method: 'POST',\n              body: JSON.stringify({\n                password: passwordResetValues.password\n              })\n            }\n          )\n\n          if (!res.ok) {\n            throw new Error('Something went wrong')\n          }\n        } else {\n          throw new Error('Passwords do not match')\n        }\n      }\n    } catch (e) {\n      setError(e.message)\n    } finally {\n      setIsLoading(() => false)\n    }\n  }\n\n  return (\n    <>\n      <AuthFormContainer\n        header={<Field.Text name=\"reset\" defaultValue=\"Reset password\" />}\n        onSubmit={e => reset(e)}>\n        {resetToken === null ? (\n          <>\n            <Field.Text\n              name=\"resetRequest\"\n              defaultValue=\"Reset your password by entering your email address below. You will\n            receive an email with a link to reset your password.\"\n            />\n\n            <TextField\n              disabled={resetRequested}\n              value={passwordResetRequestValues.email}\n              onChange={e => handleResetRequestOnChange(e, 'email')}\n              fullWidth\n              required\n              variant={'outlined'}\n              type={'email'}\n              label={t('Email Address')}\n            />\n          </>\n        ) : (\n          <>\n            <PasswordField\n              value={passwordResetValues.password}\n              handleOnChange={e => handleResetOnChange(e, 'password')}\n              required\n              fullWidth\n              label={'Password *'}\n            />\n            <PasswordField\n              value={passwordResetValues.passwordConfirmation}\n              handleOnChange={e =>\n                handleResetOnChange(e, 'passwordConfirmation')\n              }\n              required\n              fullWidth\n              label={'Confirm Password *'}\n            />\n          </>\n        )}\n\n        <LoadingButton\n          disabled={resetRequested}\n          text={t('Reset password')}\n          isLoading={isLoading}\n          fullWidth\n          variant={'contained'}\n          type={'submit'}\n        />\n        {error.length ? (\n          <div style={{color: red.A700}} className={'flex justify-center'}>\n            *{t(error)}\n          </div>\n        ) : null}\n        <div className={'flex justify-center'}>\n          <div\n            className={\n              'flex space-x-5 underline cursor-pointer text-primary duration-300'\n            }>\n            <Link to={Path.Login}>\n              <p className=\"transform hover:-translate-y-1\">\n                {t('Back to login')}\n              </p>\n            </Link>\n          </div>\n        </div>\n      </AuthFormContainer>\n      <Snackbar open={resetRequested} autoHideDuration={2000}>\n        <Alert variant=\"filled\" severity=\"success\" sx={{width: '100%'}}>\n          Reset password email sent! Please check your inbox.\n        </Alert>\n      </Snackbar>\n    </>\n  )\n}\n","import {connectPage, Field} from '@jaenjs/jaen'\nimport {Grid} from '@mui/material'\nimport {graphql, PageProps} from 'gatsby'\nimport React from 'react'\n\nimport AuthContent from '../components/Authentification/AuthContent'\nimport PasswordResetForm from '../components/Authentification/PasswordResetForm'\nimport AuthPageLayout from '../components/Layout/AuthPageLayout'\nimport NavbarPadding from '../components/Layout/NavbarPadding'\nimport PageLayout from '../components/Layout/PageLayout'\n\nexport function ResetPage(props: PageProps) {\n  return (\n    <PageLayout pathname={props.path}>\n      <AuthPageLayout>\n        <div className={'2xl:hidden'}>\n          <NavbarPadding />\n        </div>\n        <Grid container columnSpacing={12}>\n          <Grid item md={7}>\n            <div\n              className={\n                'pt-8 md:pt-0 md:h-screen flex flex-col justify-center'\n              }>\n              <PasswordResetForm />\n            </div>\n          </Grid>\n          <Grid item md={5}>\n            <AuthContent\n              header={\n                <Field.Text\n                  name=\"header\"\n                  defaultValue=\"Start quantum computing with us!\"\n                />\n              }\n              content={\n                <Field.Text\n                  name=\"content\"\n                  defaultValue=\"Our intuitive approach makes it easy for beginners to start with quantum computing and allows experts and educators to run complex photonic experiments on real quantum hardware.\"\n                />\n              }\n            />\n          </Grid>\n        </Grid>\n      </AuthPageLayout>\n    </PageLayout>\n  )\n}\n\nexport const query = graphql`\n  query ($jaenPageId: String!) {\n    ...JaenPageQuery\n  }\n`\n\nexport default connectPage(ResetPage, {displayName: 'ResetPage'})\n"],"names":["getResetTokenFromWindowLocation","window","URLSearchParams","location","search","get","PasswordResetForm","t","useTranslation","useState","isLoading","setIsLoading","error","setError","React","resetRequested","setResetRequested","password","passwordConfirmation","passwordResetValues","setPasswordResetValues","email","passwordResetRequestValues","setPasswordResetRequestValues","resetToken","setResetToken","handleResetOnChange","e","key","prev","target","value","reset","preventDefault","_context","resetPassword","fetch","method","body","JSON","stringify","ok","Error","message","_jsxs","children","AuthFormContainer","header","_jsx","Field","name","defaultValue","onSubmit","TextField","disabled","onChange","handleResetRequestOnChange","fullWidth","required","variant","type","label","PasswordField","handleOnChange","LoadingButton","text","length","style","color","red","className","Link","to","Path","Snackbar","open","autoHideDuration","Alert","severity","sx","width","ResetPage","props","PageLayout","pathname","path","AuthPageLayout","NavbarPadding","Grid","container","columnSpacing","item","md","AuthContent","content","connectPage","displayName"],"sourceRoot":""}